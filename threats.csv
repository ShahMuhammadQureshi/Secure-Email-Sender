Id,Title,Category,Diagram,Interaction,Priority,State,Changed By,Description,Justification,Last Modified,Possible Mitigation(s),SDL Phase
25,An adversary may leverage the lack of monitoring systems and trigger anomalous traffic to database,Tampering,Diagram 1,Request,High,Not Started,,An adversary may leverage the lack of intrusion detection and prevention  of anomalous database activities and  trigger anomalous traffic to database,,Generated,"Enable Threat detection on Azure SQL database. Refer: <a href=""https://aka.ms/tmtauditlog#threat-detection"">https://aka.ms/tmtauditlog#threat-detection</a>",Design
24,An adversary can tamper critical database securables and deny the action,Tampering,Diagram 1,Request,High,Not Started,,An adversary can tamper critical database securables and deny the action,,Generated,"Add digital signature to critical database securables. Refer: <a href=""https://aka.ms/tmtcrypto#securables-db"">https://aka.ms/tmtcrypto#securables-db</a>",Design
23,An adversary can deny actions on database due to lack of auditing,Repudiation,Diagram 1,Request,Medium,Not Started,,"Proper logging of all security events and user actions builds traceability in a system and denies any possible repudiation issues. In the absence of proper auditing and logging controls, it would become impossible to implement any accountability in a system.",,Generated,"Ensure that login auditing is enabled on SQL Server. Refer: <a href=""https://aka.ms/tmtauditlog#identify-sensitive-entities"">https://aka.ms/tmtauditlog#identify-sensitive-entities</a>",Implementation
22,An adversary can gain access to sensitive data by performing SQL injection,Information Disclosure,Diagram 1,Request,High,Not Started,,"SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. The primary form of SQL injection consists of direct insertion of code into user-input variables that are concatenated with SQL commands and executed. A less direct attack injects malicious code into strings that are destined for storage in a table or as metadata. When the stored strings are subsequently concatenated into a dynamic SQL command, the malicious code is executed. ",,Generated,"Ensure that login auditing is enabled on SQL Server. Refer: <a href=""https://aka.ms/tmtauditlog#identify-sensitive-entities"">https://aka.ms/tmtauditlog#identify-sensitive-entities</a>  Ensure that least-privileged accounts are used to connect to Database server. Refer: <a href=""https://aka.ms/tmtauthz#privileged-server"">https://aka.ms/tmtauthz#privileged-server</a>  Enable Threat detection on Azure SQL database. Refer: <a href=""https://aka.ms/tmtauditlog#threat-detection"">https://aka.ms/tmtauditlog#threat-detection</a>  Do not use dynamic queries in stored procedures. Refer: <a href=""https://aka.ms/tmtinputval#stored-proc"">https://aka.ms/tmtinputval#stored-proc</a>",Implementation
21,An adversary can gain access to sensitive PII or HBI data in database,Information Disclosure,Diagram 1,Request,High,Not Started,,"Additional controls like Transparent Data Encryption, Column Level Encryption, EKM etc. provide additional protection mechanism to high value PII or HBI data. ",,Generated,"Use strong encryption algorithms to encrypt data in the database. Refer: <a href=""https://aka.ms/tmtcrypto#strong-db"">https://aka.ms/tmtcrypto#strong-db</a>  Ensure that sensitive data in database columns is encrypted. Refer: <a href=""https://aka.ms/tmtdata#db-encrypted"">https://aka.ms/tmtdata#db-encrypted</a>  Ensure that database-level encryption (TDE) is enabled. Refer: <a href=""https://aka.ms/tmtdata#tde-enabled"">https://aka.ms/tmtdata#tde-enabled</a>  Ensure that database backups are encrypted. Refer: <a href=""https://aka.ms/tmtdata#backup"">https://aka.ms/tmtdata#backup</a>  Use SQL server EKM to protect encryption keys. Refer: <a href=""https://aka.ms/tmtcrypto#ekm-keys"">https://aka.ms/tmtcrypto#ekm-keys</a>  Use AlwaysEncrypted feature if encryption keys should not be revealed to Database engine. Refer: <a href=""https://aka.ms/tmtcrypto#keys-engine"">https://aka.ms/tmtcrypto#keys-engine</a>",Implementation
20,An adversary can gain unauthorized access to database due to loose authorization rules,Elevation of Privileges,Diagram 1,Request,High,Not Started,,Database access should be configured with roles and privilege based on least privilege and need to know principle. ,,Generated,"Ensure that least-privileged accounts are used to connect to Database server. Refer: <a href=""https://aka.ms/tmtauthz#privileged-server"">https://aka.ms/tmtauthz#privileged-server</a>  Implement Row Level Security RLS to prevent tenants from accessing each others data. Refer: <a href=""https://aka.ms/tmtauthz#rls-tenants"">https://aka.ms/tmtauthz#rls-tenants</a>  Sysadmin role should only have valid necessary users . Refer: <a href=""https://aka.ms/tmtauthz#sysadmin-users"">https://aka.ms/tmtauthz#sysadmin-users</a>",Implementation
19,An adversary can gain unauthorized access to database due to lack of network access protection,Elevation of Privileges,Diagram 1,Request,High,Not Started,,"If there is no restriction at network or host firewall level, to access the database then anyone can attempt to connect to the database from an unauthorized location",,Generated,"Configure a Windows Firewall for Database Engine Access. Refer: <a href=""https://aka.ms/tmtconfigmgmt#firewall-db"">https://aka.ms/tmtconfigmgmt#firewall-db</a>",Implementation
18,An adversary can reverse engineer and tamper binaries,Tampering,Diagram 1,Request,High,Not Started,,"An adversary can use various tools, reverse engineer binaries and abuse them by tampering",,Generated,"Obfuscate generated binaries before distributing to end users. Refer: <a href=""https://aka.ms/tmtdata#binaries-end"">https://aka.ms/tmtdata#binaries-end</a>",Design
17,An adversary can gain sensitive data from mobile device,Information Disclosure,Diagram 1,Request,High,Not Started,,"If application saves sensitive PII or HBI data on phone SD card or local storage, then it ay get stolen.",,Generated,"Encrypt sensitive or PII data written to phones local storage. Refer: <a href=""https://aka.ms/tmtdata#pii-phones"">https://aka.ms/tmtdata#pii-phones</a>",Implementation
16,An adversary can gain access to sensitive data by sniffing traffic from Mobile client,Information Disclosure,Diagram 1,Request,High,Not Started,LAPTOP-EL7RN2KS\shahm,An adversary can gain access to sensitive data by sniffing traffic from Mobile client,,12/13/2024 20:01,"Implement Certificate Pinning. Refer: <a href=""https://aka.ms/tmtcommsec#cert-pinning"">https://aka.ms/tmtcommsec#cert-pinning</a>",Implementation
15,An adversary may jail break into a mobile device and gain elevated privileges,Elevation of Privileges,Diagram 1,Request,High,Not Started,,An adversary may jail break into a mobile device and gain elevated privileges,,Generated,"Implement implicit jailbreak or rooting detection. Refer: <a href=""https://aka.ms/tmtauthz#rooting-detection"">https://aka.ms/tmtauthz#rooting-detection</a>",Design
